<script setup lang="ts">
import Header from '../layouts/header/header.vue';
import Footer from '../layouts/footer/footer.vue';
import { ref } from 'vue';

const formData = ref({
  name: '',
  email: '',
  message: '',
  subject: '–û–±—â–∏–π –≤–æ–ø—Ä–æ—Å'
});

const isLoading = ref(false);
const isSubmitted = ref(false);
const errorMessage = ref('');

const subjects = ref([
  '–û–±—â–∏–π –≤–æ–ø—Ä–æ—Å',
  '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞',
  '–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ',
  '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é',
  '–î—Ä—É–≥–æ–µ'
]);

const handleSubmit = async () => {
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
  if (!formData.value.name.trim()) {
    errorMessage.value = '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è';
    return;
  }

  if (!formData.value.email.includes('@')) {
    errorMessage.value = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email';
    return;
  }

  if (!formData.value.message.trim()) {
    errorMessage.value = '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ';
    return;
  }

  isLoading.value = true;
  errorMessage.value = '';

  try {
    // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    await new Promise(resolve => setTimeout(resolve, 1500));
    isSubmitted.value = true;
    formData.value = { name: '', email: '', message: '', subject: '–û–±—â–∏–π –≤–æ–ø—Ä–æ—Å' };
  } catch (error) {
    errorMessage.value = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
    console.error('Form error:', error);
  } finally {
    isLoading.value = false;
  }
};
</script>

<template>
  <Header/>
  <main class="contacts-page">
    <div class="container">
      <section class="page-header">
        <h1>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
        <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
      </section>

      <div class="contacts-content">
        <div class="contact-info-section">
          <h2><i class="fas fa-info-circle"></i> –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
          
          <div class="contact-method">
            <div class="icon-wrapper">
              <i class="fas fa-map-marker-alt">üìç</i>
            </div>
            <div>
              <h3>–ê–¥—Ä–µ—Å</h3>
              <p>–≥. –ò–∂–µ–≤—Å–∫, —É–ª. –ü—É—à–∫–∏–Ω—Å–∫–∞—è, –¥. 268–ñ</p>
            </div>
          </div>

          <div class="contact-method">
            <div class="icon-wrapper">
              <i class="fas fa-phone-alt">üìû</i>
            </div>
            <div>
              <h3>–¢–µ–ª–µ—Ñ–æ–Ω</h3>
              <p>+7 (495) 123-45-67</p>
            </div>
          </div>

          <div class="contact-method">
            <div class="icon-wrapper">
              <i class="fas fa-envelope">üìß</i>
            </div>
            <div>
              <h3>Email</h3>
              <p>info@mvek-portfolio.ru</p>
            </div>
          </div>

          <div class="contact-method">
            <div class="icon-wrapper">
              <i class="fas fa-clock">üïê</i>
            </div>
            <div>
              <h3>–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</h3>
              <p>–ü–Ω-–ü—Ç: 9:00 - 18:00</p>
              <p>–°–±-–í—Å: –≤—ã—Ö–æ–¥–Ω–æ–π</p>
            </div>
          </div>

          <div class="social-media">
            <h3>–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</h3>
            <div class="social-icons">
              <a href="#" aria-label="–í–ö–æ–Ω—Ç–∞–∫—Ç–µ"><i class="fab fa-vk"></i></a>
              <a href="#" aria-label="Telegram"><i class="fab fa-telegram"></i></a>
              <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            </div>
          </div>
        </div>

        <div class="map-section">
          <h2><i class="fas fa-map-marked-alt"></i> –ö–∞–∫ –Ω–∞—Å –Ω–∞–π—Ç–∏</h2>
          <div class="map-container">
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ -->
            <iframe 
              src="https://yandex.ru/map-widget/v1/?um=constructor%3A1a2b3c4d5e6f7g8h9i0j&amp;source=constructor"
              frameborder="0"
              class="map-iframe"
              aria-label="–ö–∞—Ä—Ç–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è"
            ></iframe>
          </div>
        </div>

        <div class="contact-form-section">
          <h2><i class="fas fa-paper-plane"></i> –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</h2>
          
          <div v-if="isSubmitted" class="success-message">
            <i class="fas fa-check-circle"></i>
            <p>–°–ø–∞—Å–∏–±–æ! –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ.</p>
            <button @click="isSubmitted = false" class="new-message-btn">
              –ù–∞–ø–∏—Å–∞—Ç—å –µ—â—ë
            </button>
          </div>

          <form v-else @submit.prevent="handleSubmit" class="feedback-form">
            <div class="form-group">
              <label for="name">–í–∞—à–µ –∏–º—è*</label>
              <input
                v-model="formData.name"
                type="text"
                id="name"
                placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω"
                required
              >
            </div>

            <div class="form-group">
              <label for="email">Email*</label>
              <input
                v-model="formData.email"
                type="email"
                id="email"
                placeholder="example@mail.ru"
                required
              >
            </div>

            <div class="form-group">
              <label for="subject">–¢–µ–º–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è</label>
              <select v-model="formData.subject" id="subject">
                <option v-for="(subject, index) in subjects" :key="index" :value="subject">
                  {{ subject }}
                </option>
              </select>
            </div>

            <div class="form-group">
              <label for="message">–°–æ–æ–±—â–µ–Ω–∏–µ*</label>
              <textarea
                v-model="formData.message"
                id="message"
                rows="5"
                placeholder="–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                required
              ></textarea>
            </div>

            <div v-if="errorMessage" class="error-message">
              <i class="fas fa-exclamation-circle"></i>
              {{ errorMessage }}
            </div>

            <button type="submit" :disabled="isLoading" class="submit-btn">
              <span v-if="!isLoading">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
              <span v-else class="loading-spinner"></span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </main>
  <Footer/>
</template>
<style scoped>
@import "./contact.scss";
</style>